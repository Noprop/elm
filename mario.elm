import Html
import Html.Attributes exposing (height, src, width)

img : Float -> Float -> String -> Shape userMsg
img w h url =
    html w h (Html.img [ src url, width (round w), height (round h) ] [])
        |> move ( -w / 2, h / 2 )


myShapes model =
  [
    rect 200 200 |> filled (rgb 132 180 252)
    , (generateBlocks model.blocks) |> group |> move (model.cam, 0)
    , (generateBlocks model.blocks2) |> group |> move (model.cam, 0)
    , goomba 0 model
    , goomba 1 model
    
    
    
    
    , img 32 32 (sprite model)
    |> scaleX (3/8*model.flip) |> scaleY (3/8)
    |> move (model.cam + toFloat(round(model.xpos*10))/10, toFloat(round(model.ypos*5))/5)
 ]
 
goomba n model = (if gz (index model.goombs n) /= 0.5 && gz (index model.goombs n) /= -0.5 then
                   if model.time - gz (index model.goombs n) < 0.9 then
                     img 32 32 "data:image/png;base64,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"
                   else
                     rect 32 32 |> ghost
                 else
                   img 32 32 "https://piskel-imgstore-b.appspot.com/img/c169c728-afee-11ed-aa41-b103606f20e2.gif")
               |> scale (3/8)
               |> move (gx (index model.goombs n) + model.cam, gy (index model.goombs n))

sprite model = if model.anim == Walk then
                 "https://piskel-imgstore-b.appspot.com/img/04025e8f-af12-11ed-8470-8fa35cda274a.gif"
               else if model.anim == Jump then
                 "data:image/png;base64,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"
               else if model.anim == Fall then
                 "data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAAQAAAAEACAYAAABccqhmAAAAAXNSR0IArs4c6QAADDFJREFUeF7t3bHNJNcVhNGRwUhkcDPYECSTadASAToMYR0CpKU0aIohbAYrg5HIWEEClEB/DdQ89ZFf3e+ve+fwrTGjP738LzXw5cPra3rAw8Mfvrz+9PAKpn++8mP9AGgFAqD1V9MAiA0CoBUIgNZfTQMgNgiAViAAWn81DYDYIABagQBo/dU0AGKDAGgFAqD1V9MAiA0CoBUIgNZfTQMgNgiAViAAWn81DYDYIABagQBo/dU0AGKDAGgFAqD1V9MAiA0CoBUIgNZfTQMgNgiAViAAWn81DYDYIABagQBo/dU0AGKDAGgFAqD1V9MAiA0CoBUIgNZfTQMgNgiAViAAWn81/XgAfIDrCj07fzpgAPCDHs/+BMe/HgCxwHXcDWA9gbPfD4Cz5/cCwOEDHB8fAOMB1NcDoDb47DwADp8/AA4f4Pj4ABgPoL4eALXBZ+cBcPj8AXD4AMfHB8B4APX1AKgNPjsPgMPnD4DDBzg+PgDGA6ivB0Bt8Nl5ABw+fwAcPsDx8QEwHkB9PQBqg8/OA+Dw+QPg8AGOjw+A8QDq6wFQG3x2HgCHzx8Ahw9wfHwAjAdQX//pb6+v9RnL/I8fPi5f//r5n5/T+3/8tp3/m+8/P/4r7WUAjy8PAGV9XgBo9c3TAHADSEvoBpDqm4cBAIC0hABI9c3DAABAWkIApPrmYQAAIC0hAFJ98zAAAJCWEACpvnkYAABISwiAVN88DAAApCUEQKpvHgYAANISAiDVNw8DAABpCQGQ6puHAQCAtIQASPXNwwAAQFpCAKT65mEAACAtIQBSffMwAACQlhAAqb55GAAASEsIgFTfPHw8APXrvPX79D9/id+HH3+fv27g0//+03+PAADxA/j0D8DT/34A1P+ExLwbQCwwxgFw9i8SuQG4ASQCAACAtEA17AZQG2x5AACgbVBMAyAWGOMAAEBcoRYHQOuvpgEAgLpDKQ+AVF8OAwAAeYnKAwBQ2utZAACgb1F4AgBCeTdEAQCAG9bo+iMAcL27O5IAAMAde3T5GQC4XN0tQQAA4JZFuvoQAFxt7p4cAABwzyZdfAoALhZ3UwwAALhpla49BgDXersrBQAA3LVLl54DgEu13RYCAABuW6YrD/r0w+vrldz/MvX/n75+AMrZ/5Otv2dQ31/ztb/T//7114nP/zYgAOpncJoHwPYGAYBvP6YPQF3g9HI3gONvQG4A8RPgnwANsFh/jldA/ROgjcANwA2gbVBMA8A/AdIKuQG4AaQFGof9EyAOAAAAiCs0jQMg1g8AAMQVmsYBEOsHAADiCk3jAIj1AwAAcYWmcQDE+gEAgLhC0zgAYv0AAEBcoWkcALF+AAAgrtA0DoBYPwAAEFdoGgdArB8AAIgrNI0DINYPAADEFZrGARDrrz8IEl9//LfR6t//8z8/10e0fPo1iNfrFb8N89Mv9Qntz6/p+OfX1/c8AHqH5QkAAEDZn5wFQK4wPQAAAEgLVMMAqA22PAAA0DYopgEQC4xxAAAgrlCLA6D1V9MAAEDdoZQHQKovhwEAgLxE5QEAKO31LAAA0LcoPAEAobwbogAAwA1rdP0RALje3R1JAADgjj26/AwAXK7uliAAAHDLIl19CACuNndPDgAAuGeTLj4FABeLuykGAADctErXHgOAa73dlQIAAO7apUvPAcCl2m4LAQAAty3TlQcB4Epr92UAAID7tunAJ/3r7x/rN9IP/Kv/f468/kGOdZPH/x7AukAArCfQ3g+A1t/j0wA4ewUAcPb85qcHwHwE6QAASPUJA+DsHQDA2fObnx4A8xGkAwAg1ScMgLN3AABnz29+egDMR5AOAIBUnzAAzt4BAJw9v/npATAfQToAAFJ9wgA4ewcAcPb85qcHwHwE6QAASPUJA+DsHQDA2fObnx4A8xGkAwAg1ScMgLN3AABnz29+egDMR5AOAIBU3/nhTz+82vf5W/r13e+tw9/+2vLxr48vf71++vXsH9TIBYwf8PjfAwDAdgMBsO0fAG4A0w0EwLR+1y83gO0CAmDbvxuAG8B0AwEwrd8NwA1gu4AA2PbvBuAGMN1AAEzrdwNwA9guIAC2/bsBuAFMNxAA0/rdANwAtgsIgG3/bgBuANMNBMC0fjcAN4DtAgJg278bgBvAdAMBMK3fDcANYLuAANj27wbgBjDdQABM63cDcAPYLiAAtv0ffwPIH+Bt//nt3/0jPyI9YP17BABJ4zv/BgCAtgA1DYDa4DbvBrDtP7/dDeD8/4jlJQgPAEAo7x2iAABA2UMAlPbeIAsAAJQ1BEBp7w2yAABAWUMAlPbeIAsAAJQ1BEBp7w2yAABAWUMAlPbeIAsAAJQ1BEBp7w2yAABAWUMAlPbeIAsAAJQ1BEBp7w2yAABAWUMAlPbeIAsAAJQ1BEBp7w2yAABAWUMAlPbeIAsAAJQ1BEBp7w2yAABAWUMAlPZuyK4/wH/+28f0V/zx6+eUr+F6/m++/3z8Z6B0ePwff/rvAQCgrO/rBYDWHwBafzkNgFYhAFp/AGj95TQAWoUAaP0BoPWX0wBoFQKg9QeA1l9OA6BVCIDWHwBafzkNgFYhAFp/AGj95TQAWoUAaP0BoPWX0wBoFQKg9QeA1l9OA6BVCIDWHwBafzkNgFYhAFp/AGj95TQAWoUAaP0BoPWX0wBoFQKg9QeA1l9OA6BVCIDWHwBafzkNgFYhAFp/AGj95TQAWoUAaP0BoPXX01/bI777veWfnv7w5dk/KAKA9ScAANMJAGBaf3/56T8I8gJAX4LwBACE8t4hCoB3mMK5ZwDAubP778kBcPgAx8cHwHgA9fUAqA0+Ow+Aw+cPgMMHOD4+AMYDqK8HQG3w2XkAHD5/ABw+wPHxATAeQH09AGqDz84D4PD5A+DwAY6PD4DxAOrrAVAbfHYeAIfPHwCHD3B8fACMB1BfD4Da4LPzADh8/gA4fIDj4wNgPID6egDUBp+dB8Dh8//yoX2f7re/xALiF6p//PZjPMA2/sevn7cHiG8HQCxwHQfAdgIA2PZf3x7/+1Vf3/MA6B2WJwCgtLfPAsA/AdIWAiDVNw8DAABpCQGQ6puHAQCAtIQASPXNwwAAQFpCAKT65mEAACAtIQBSffMwAACQlhAAqb55GAAASEsIgFTfPAwAAKQlBECqbx4GAADSEgIg1TcPAwAAaQkBkOqbhwEAgLSEAEj1zcMAAEBaQgCk+uZhAAAgLSEAUn3z8PEA1Abztwn/2k6w/j0AH+A2v9PTAKg/KAKA6Wfg6T/oUcsHAADqDk3zAGj1AwAAbYPGaQC0AQAAAG2DxmkAtAEAAABtg8ZpALQBAAAAbYPGaQC0AQAAAG2DxmkAtAEAAABtg8ZpALQBAAAAbYPGaQC0AQAAAG2DxmkAtAEAAABtg8ZpALQBAAAAbYPGaQC0AQAAAG2DxmkAtAEAAABtg8ZpALQBAAAAbYPGaQC0ATwegFbf61V/T6C+v+Z/i19nru+v+Z9+ednhUKLyQnn/iQIgFhjjAGgFAqD1B4DYX40DoDUIgNYfAGJ/NQ6A1iAAWn8AiP3VOABagwBo/QEg9lfjAGgNAqD1B4DYX40DoDUIgNYfAGJ/NQ6A1iAAWn8AiP3VOABagwBo/QEg9lfjAGgNAqD1B4DYX40DoDUIgNYfAGJ/NQ6A1iAAWn8AiP3VOABagwBo/QEg9lfjAGgNAqD1B4DYX40DoDUIgNYfAGJ/NQ6A1iAAWn+vTz+8vsZHiA8beDogAIjLB4BY4DgOgPEATn89AM6eIADOnt/89ACYjyAdAACpPmEAnL0DADh7fvPTA2A+gnQAAKT6hAFw9g4A4Oz5zU8PgPkI0gEAkOoTBsDZOwCAs+c3Pz0A5iNIBwBAqk8YAGfvAADOnt/89ACYjyAdAACpPmEAnL0DADh7fvPTA2A+gnQAAKT6hAFw9g4A4Oz5zU8PgPkI0gEAkOoTfjoAT/8Anf4J8HsAcYIAeNmhuEPLuOHF9gEAgLhC0zgAYv0AAEBcoWkcALF+AAAgrtA0DoBYPwAAEFdoGgdArB8AAIgrNI0DINYPAADEFZrGARDrBwAA4gpN4wCI9QMAAHGFpnEAxPoBAIC4QtM4AGL9AABAXKFpHACxfgAAIK7QNA6AWD8AABBXaBoHQKwfAACIKzSNAyDWDwAAxBWaxv8N8QXhTK65sfsAAAAASUVORK5CYII="
                 --"data:image/png;base64,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"
                 --"data:image/png;base64,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"
               else if model.anim == Idle then
                 "data:image/png;base64,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"
               else
                 "data:image/png;base64,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"

checkColX x1 x2 = if x1 < x2
                          then x1 + 5.25 > x2 - 5.25
                        else
                          x1 - 5.25 < x2 + 5.25
                                     
checkColY y1 y2 = if y1 < y2
                          then y1 + 6 > y2 - 6
                        else
                          y1 - 6 < y2 + 6
                          
checkDieX x1 x2 = if x1 < x2
                          then x1 + 4 > x2 - 4
                        else
                          x1 - 4 < x2 + 4
                                     
checkDieY y1 y2 = if y1 < y2
                          then y1 + 4 > y2 - 4
                        else
                          y1 - 4 < y2 + 4
  
checkColOne x y bx by = (checkColX x bx) && (checkColY y by)

checkColDie x y bx by = (checkDieX x bx) && (checkDieY y by)

checkColTop x y bx by = (checkColX x bx) && y - 6 > by && y < by + 12
  
checkColAll : Float -> Float -> List (Float,Float) -> Bool
checkColAll x y blocks = case blocks of
  [] -> False
  (blockx,blocky)::z -> if (checkColOne x y (blockx*12) (blocky*12)) then
                          True
                        else
                          checkColAll x y z

generateBlocks blocks = case blocks of
  [] -> []
  (x,y)::z -> [img 32 32 "data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAAQAAAAEACAYAAABccqhmAAAAAXNSR0IArs4c6QAADTBJREFUeF7t3bGRnGeWBdGGDTABFsAVRkBvZWSqNIEqZSijIwKuwAKaQBs4MSZ0HeFWxcuV9/b3M1927qzAnk/f37/8+wb/89vvf8K66asT+Pz1G/0jfH//Qvvr/v386w/i96kAEL/z4wKwVaAAbPmff70AbBUoAFv+518vAFsFCsCW//nXC8BWgQKw5X/+9QKwVaAAbPmff70AbBUoAFv+518vAFsFCsCW//nXC8BWgQKw5X/+9QKwVaAAbPmff70AbBUoAFv+518vAFsFCsCW//nXC8BWgQKw5X/+9QKwVaAAbPmff70AbBUoAFv+518vAFsFOAD//PpBfw9AP2CLr9eVwH/++zf9iH9+/aD9df+U/6cCQP6dH6uABcAUUv4FwPifX6uABcAUUv4FwPifX6uABcAUUv4FwPifX6uABcAUUv4FwPifX6uABcAUUv4FwPifX6uABcAUUv4FwPifX6uABcAUUv4FwPifX6uABcAUUv4FwPifX6uABcAUUv4FwPifX6uABcAUUv4FwPifX6uABcAUUv4FwPifX6uABcAUUv4FwPifX6uABcAUUv4FwPifX6uABcAUUv4FwPifX6uABcAUUv4FwPifX6uABcAUUv4FwPifX6uABcAUUv4FwPifX6uABcAUUv4FwPifX6uABcAUUv4FwPifX6uABcAUUv4FwPifX6uABcAUUv4FwPifX6uABcAUUv4FwPifX6uABcAUUv4FwPifX6uABcAUUv4FwPifX6uABcAUUv4FwPifX6uABcAUUv4FwPifX6uABcAUUv4FwPifX6uABcAUUv4FwPifX6uABcAUUv4FwPifX6uABcAUUv4FwPifX6uABcAUUv4FwPifX6uABcAUUv4FwPifX6uABcAUUv4FwPifX6uABcAUUv4FwPifX6uABcAUUv4FwPifX6uABcAUUv4FwPifX6uABcAUUv4FwPifX6uABcAUUv4FwPifX6uABcAUUv4FwPifX6uABcAUUv4FwPifX6uABcAUUv4FwPifX6uABcAUUv4FwPifX6uABcAUUv4FwPifX6uABcAUUv4FwPifX6uABcAUUv4FwPifX6uABcAUUv4FwPifX6uABcAUUv4FwPifX6uAGoDP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"
             |> scale (3/8)
             |> move (x*12,y*12)]
             ++ generateBlocks z

type Anim = Idle | Walk | Jump | Fall | Die

type Msg = Tick Float GetKeyState
          | Camera (Keys -> KeyState)
          | Death (Keys -> KeyState)
          | DeathAnim
          | CheckColY (Keys -> KeyState)
          | MoveY (Keys -> KeyState)
          | MoveX (Keys -> KeyState)
          | Goomb

update : Msg -> Model -> Model
update msg model = case msg of
  Tick t (isk,_,_) ->
    if t - model.delta > 0.01 then
    let
      newModel = update (Camera isk) model
    in
      {newModel | time = t, delta = t}
    else
      {model | time = t}
  Camera isk ->
    let
      newModel = update (Death isk) model
    in
      if newModel.xpos + model.cam > -20 then
        {newModel | cam = -newModel.xpos - 20}
      else if newModel.xpos + model.cam < -30 && model.cam < 0 then
          {newModel | cam = -newModel.xpos - 30}
      else
        if newModel.xpos < -90 then
          {newModel | xpos = -90, anim = if newModel.anim == Jump then Jump else Idle}
        else
          newModel
  Death isk -> 
    let
      newModel = if not model.death then update (CheckColY isk) model else update DeathAnim model
      goombCheck n = if n >= List.length newModel.goombs then
                       False
                     else
                       if checkColDie newModel.xpos newModel.ypos (gx (index newModel.goombs n)) (gy (index newModel.goombs n)) && (gz (index newModel.goombs n) == 0.5 || gz (index newModel.goombs n) == -0.5) then
                         True
                       else
                         goombCheck (n+1)
    in
      if not model.death then
        {newModel | death = newModel.ypos < -75 || goombCheck 0, deathTime = model.time, deathY = newModel.ypos}
      else
        newModel
  DeathAnim ->
    if model.time - model.deathTime < 2 then
      {model | ypos = model.deathY - (10*(model.time - model.deathTime - 0.6))^2 + 36, anim = Die}
    else
      init
  CheckColY isk ->
    let
      movey = update (MoveY isk) model
      findy y d = if checkColAll movey.xpos y model.blocks then
                      findy (y+(0.1*d)) d
                    else if movey.yv > 0 then
                      y - 0.1
                    else
                      y
      dir = if movey.yv < 0 then
              1
            else
              -1
      leftDown = isk LeftArrow == Down || isk (Key "a") == Down
      rightDown = isk RightArrow == Down || isk (Key "d") == Down
    in
      if (checkColAll movey.xpos movey.ypos model.blocks) then
        {movey | 
        ypos = findy movey.ypos dir
        , anim = if movey.yv >= 0 then
                   Jump
                 else if ((leftDown && not rightDown && checkColAll (movey.xpos-1) (movey.ypos+0.15) model.blocks == False) || (rightDown && not leftDown && checkColAll (movey.xpos+1) (movey.ypos+0.15) model.blocks == False)) then
                   Walk
                 else
                   Idle
        , yv = 0
        }
      else
        movey
  MoveY isk -> 
    let
      movex = update (MoveX isk) model
      spacePress = isk Space == JustDown || isk (Key "w") == JustDown || isk UpArrow == JustDown
      spaceDown = isk Space == Down || isk (Key "w") == Down || isk UpArrow == Down
      leftDown = isk LeftArrow == Down || isk (Key "a") == Down
      rightDown = isk RightArrow == Down || isk (Key "d") == Down
      goombCheck n = if n >= List.length movex.goombs then
                       False
                     else
                       (gz (index movex.goombs n) == model.time) || goombCheck (n+1)
    in
    if (spacePress && checkColAll movex.xpos (model.ypos-0.1) model.blocks) || goombCheck 0 then
    {movex |
    yv = 2.6
    , ypos = model.ypos + 2.6
    , anim = Jump
    }
    else
    {movex |
    yv = if model.yv < -3 then
           -3
         else if model.yv <= 0 then
           model.yv - 0.15
         else if spaceDown then
           model.yv - 0.1
         else
           model.yv - 0.2
    , ypos = model.ypos + model.yv
    , anim = if (model.yv < 0 && movex.anim /= Jump && not leftDown && not rightDown) then Fall else movex.anim
    }
  MoveX isk -> 
    let
      newModel = update (Goomb) model
      leftDown = isk LeftArrow == Down || isk (Key "a") == Down
      rightDown = isk RightArrow == Down || isk (Key "d") == Down
    in
    if (leftDown && (not rightDown)) then
      if (checkColAll (model.xpos - 1) (model.ypos+0.15) model.blocks) then
        if model.anim /= Jump then
          {newModel | anim = if model.yv == 0 then Idle else Fall}
        else
          newModel
      else
        if model.anim == Jump then
          {newModel | xpos = model.xpos - 1}
        else
          {newModel | xpos = model.xpos - 1, anim = Walk, flip = -1}
        
    else if ((not leftDown) && rightDown) then
      if (checkColAll (model.xpos + 1) (model.ypos+0.15) model.blocks) then
        if model.anim /= Jump then
          {newModel | anim = if model.yv == 0 then Idle else Fall}
        else
          newModel
      else
        if model.anim == Jump then
          {newModel | xpos = model.xpos + 1}
        else
          {newModel | xpos = model.xpos + 1, anim = Walk, flip = 1}
    else
      if model.anim /= Jump then
        {newModel | anim = Idle}
      else
        newModel
  Goomb ->
    let
      newGoombs n = if n >= 2 then
                      []
                    else if gy (index model.goombs n) == 300 then
                      [index model.goombs n] ++ newGoombs (n+1)
                    else
                      [newPos n] ++ newGoombs (n+1)
      newY n = if checkColAll (gx (index model.goombs n)) (gy (index model.goombs n) - 1.5) model.blocks then
        gy (index model.goombs n)
               else
        gy (index model.goombs n) - 1.5
      
      newPos n = if checkColTop model.xpos model.ypos (gx (index model.goombs n)) (gy (index model.goombs n)) || (gz (index model.goombs n) /= 0.5 && gz (index model.goombs n) /= -0.5) then
                   if gz (index model.goombs n) == 0.5 || gz (index model.goombs n) == -0.5 then
                     (gx (index model.goombs n), gy (index model.goombs n), model.time)
                   else
                     (gx (index model.goombs n), gy (index model.goombs n), gz (index model.goombs n))
                 else if checkColAll (gx (index model.goombs n) + gz (index model.goombs n)) (gy (index model.goombs n)) model.blocks then
        (gx (index model.goombs n), newY n , (gz (index model.goombs n))*(-1))
                 else
        (gx (index model.goombs n) + gz (index model.goombs n), newY n, (gz (index model.goombs n)))
      
    in
    {model | goombs = newGoombs 0} 
    
    

type alias Model = { time : Float
                    , xpos : Float
                    , ypos : Float
                    , yv : Float
                    , goombs : List (Float, Float, Float)
                    , blocks : List (Float, Float)
                    , blocks2 : List (Float, Float)
                    , anim : Anim
                    , flip : Float
                    , cam : Float
                    , death : Bool
                    , deathTime : Float
                    , deathY : Float
                    , delta : Float}

init = { time = 0
        , xpos = -24.5
        , ypos = -48
        , yv = 0
        , goombs = [(48,0,-0.5), (60,-36,-0.5)]
        , blocks = [(28,-5),(27,-5),(26,-5),(25,-5),(24,-5),(23,-5),(16,-5),(15,-5),(14,-5),(13,-5),(12,-5),(9,-5),(8,-5),(7,-5),(6,-5),(5,-5),(4,-5),(3,-5),(2,-5),(1,-5),(0,-5),(-1,-5),(-2,-5),(-3,-5),(-4,-5),(-5,-5),(-6,-5),(-7,-5),(-8,-5),(28,-4),(27,-4),(26,-4),(25,-4),(24,-4),(23,-4),(16,-4),(15,-4),(14,-4),(13,-4),(12,-4),(9,-4),(8,-4),(7,-4),(6,-4),(5,-4),(4,-4),(3,-4),(2,-4),(1,-4),(0,-4),(-1,-4),(-2,-4),(-3,-4),(-4,-4),(-5,-4),(-6,-4),(-7,-4),(-8,-4),(-2,-3),(18,-1),(6,-1),(5,-1),(4,-1),(5,2)]
        , blocks2 = []
        , anim = Idle
        , flip = 1
        , cam = 0
        , death = False
        , deathTime = 0
        , deathY = 0
        , delta = 0
        }

main = gameApp Tick { model = init, view = view, update = update, title = "Game Slot" }

view model = collage 192 128 (myShapes model)



----------------
--list functions
----------------


index list n = case n of
                0 -> head list
                _ -> index (tail list) (n-1)

replace list x n = case n of
                    0 -> [x] ++ (tail list)
                    _ -> [head list] ++ (replace (tail list) x (n-1))

gx (x,_,_) = x
gy (_,y,_) = y
gz (_,_,z) = z

head x = headAux (List.head x)
tail x = tailAux (List.tail x)

headAux x = case x of
              Just l -> l
              Nothing -> Debug.todo "unimplemented"

tailAux x = case x of
              Just l -> l
              Nothing -> []